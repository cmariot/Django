{% comment %} Bootstrap JS Scripts {% endcomment %}

<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>



{% comment %} Login script {% endcomment %}

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"
        ></script>
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }


    function getCSRFToken() {
        return getCookie('csrftoken');
    }


    {% comment %} $(document).on('submit', '#login-form', function(event) {
        event.preventDefault();
        $.ajax({
            url: '{% url "login" %}',
            type: 'POST',
            data: {
                username: $('#id_username').val(),
                password: $('#id_password').val(),
                csrfmiddlewaretoken: getCSRFToken()
            },
            success: function(response) {
                if (response.success) {
                    console.log('success');
                } else {
                    $('#login-error-messages').html('');
                    $.each(response.errors, function(key, value) {
                        console.log(value);
                        $('#login-error-messages').append('<div class="alert alert-danger">' + value + '</div>');
                    });
                }
            }
        });
    }); {% endcomment %}

    {% comment %} $(document).on('submit', '#register-form', function(event) {
        event.preventDefault();
        $.ajax({
            url: '{% url "register" %}',
            type: 'POST',
            data: {
                username: $('#id_username').val(),
                password: $('#id_password').val(),
                password_confirmation: $('#id_password2').val(),
                csrfmiddlewaretoken: getCSRFToken()
            },
            success: function(response) {
                if (response.success) {
                    console.log('success');
                } else {
                    $('#register-error-messages').html('');
                    $.each(response.errors, function(key, value) {
                        console.log(value);
                        $('#register-error-messages').append('<div class="alert alert-danger">' + value + '</div>');
                    });
                }
            }
        });
    }); {% endcomment %}

    $(document).on('click', '.register', function(event) {
        event.preventDefault();
        $.ajax({
            url: '{% url "register" %}',
            type: 'GET',
            success: function(response) {
                $('main').html(response);
            }
        });
    });

    $(document).on('click', '.login', function(event) {
        event.preventDefault();
        $.ajax({
            url: '{% url "login" %}',
            type: 'GET',
            success: function(response) {
                $('main').html(response);
            }
        });
    });

</script>


